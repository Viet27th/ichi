{"version":3,"file":"static/webpack/static/development/pages/_app.js.3bc2000fd6a80ffda1fb.hot-update.js","sources":["webpack:///./services/axios.service.js"],"sourcesContent":["import axios from 'axios';\nimport cookie from './cookie.service';\nimport {AlertComponentEvolution} from '../components/alert';\nimport Router from 'next/router';\nimport {express_api} from './express_api.service';\n\n/**\n *\n * @param req - if request come from Nextjs server, we've merely pass this params\n * @returns {AxiosInstance}\n */\nexport const axiosInstance = function (req) {\n  let token;\n  if (req) {\n    token = cookie.serverGetCookieByName(req, 'token');\n  } else {\n    token = cookie.clientGetCookieByName('token');\n  }\n  \n  let axiosInstance = axios.create({\n    timeout: 9000\n  });\n  axiosInstance.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n  \n  /**\n   * Add a request interceptor to verify before send request\n   * Request never sent if token is invalid\n   */\n  axiosInstance.interceptors.request.use(function (config) {\n    // Do something before request is sent, if it's ok, you must be return \"config\" otherwise request never be sent\n    \n    let userProfile = cookie.verifyJWT(token);\n    if (!userProfile && config.url !== express_api.webLoginTraditionalUrl) {\n      // Ném ra 1 lỗi và sẽ được bắt ở catch khi gửi request. Giống như việc request trả về status khác 200.\n      throw new Error('token error');\n    }\n    return config;\n  }, function (error) {\n    // Do something with request error\n    console.log(2)\n    console.log('axios handle request error: ',error);\n    return Promise.reject(error);\n  });\n  \n  // Add a response interceptor\n  axiosInstance.interceptors.response.use(function (response) {\n    // Do something with response data\n    return response;\n  }, function (error) {\n    // Do something with response error\n    return Promise.reject(error);\n  });\n  \n  return axiosInstance;\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;;;;;;AAKA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AAEA;;;;;AAIA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;;;A","sourceRoot":""}