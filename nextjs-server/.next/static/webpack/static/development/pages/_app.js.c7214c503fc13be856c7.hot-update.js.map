{"version":3,"file":"static/webpack/static/development/pages/_app.js.c7214c503fc13be856c7.hot-update.js","sources":["webpack:///./components/login/index.js","webpack:///./components/login/style.css","webpack:///./services/axios.service.js"],"sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport style from './style.css';\nimport Link from 'next/link';\nimport Router from 'next/router';\nimport {axiosInstance} from '../../services/axios.service';\nimport {regexEmail} from '../../services/regex.service';\nimport {AlertComponentEvolution} from '../../components/alert';\nimport {SpinnerComponentEvolution} from '../../components/spinner';\nimport cookie from '../../services/cookie.service';\nimport middleware from '../../middleware';\nimport {express_api} from '../../services/express_api.service';\n\nclass LoginComponent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      email: '',\n      password: ''\n    };\n  }\n  \n  render() {\n    return (\n      <div id=\"wrapped-login\">\n        <div id='login'>\n          <h2>Login</h2>\n          <input name='email' placeholder='Email' type='text'\n                 value={this.state.email}\n                 onChange={this.handleChange}\n          />\n          <input name='password' placeholder='Password' type='password'\n                 value={this.state.password}\n                 onChange={this.handleChange}\n          />\n          \n          <div className='social pt-5 pb-3 d-flex justify-content-center align-items-center'>\n            <span className='twitter cursor-pointer'>\n              <i className=\"fab fa-twitter\"></i>\n            </span>\n            <span className='facebook cursor-pointer'>\n              <i className=\"fab fa-facebook-f\"></i>\n            </span>\n            <span className='google-plus cursor-pointer'>\n              <i className=\"fab fa-google-plus-g\"></i>\n            </span>\n            <span className='youtube cursor-pointer'>\n              <i className=\"fab fa-github\"></i>\n            </span>\n          </div>\n          \n          <input type='submit' value='Login' onClick={this.handleSubmit}/>\n        </div>\n        \n        <style jsx>{style}</style>\n      </div>\n    );\n  }\n  \n  /**\n   * Refer: https://medium.freecodecamp.org/what-i-wish-i-knew-when-i-started-to-work-with-react-js-3ba36107fd13\n   * @param e\n   */\n  handleChange = e => {\n    let {target} = e;\n    this.setState({\n      [target.name]: target.value\n    });\n  };\n  \n  handleSubmit = () => {\n    if (!regexEmail(this.state.email) || this.state.email.trim() === '') {\n      AlertComponentEvolution.show('Email không chính xác.');\n    } else if (this.state.password.trim() === '') {\n      AlertComponentEvolution.show('Password không được để trống.');\n    } else {\n      SpinnerComponentEvolution.show();\n      axiosInstance().post(express_api.webLoginTraditionalUrl, {\n        email: this.state.email,\n        password: this.state.password\n      }).then(result => {\n        SpinnerComponentEvolution.hide();\n        if (result.data.requestSuccessfully) {\n          // Set cookie client\n          cookie.clientSetCookie('token', result.data.data.token, result.data.data.expMillisecond);\n  \n          let el = document.getElementById('dirtyWayToInjectLoginComponent');\n          if (el) {\n            document.body.style.overflow = null;\n            ReactDOM.unmountComponentAtNode(el);\n            document.body.removeChild(el);\n          }\n          \n        } else {\n          AlertComponentEvolution.show(result.data.message);\n        }\n      }).catch(error => {\n        SpinnerComponentEvolution.hide();\n        console.log(error);\n        AlertComponentEvolution.show(error.message);\n      });\n    }\n  };\n}\n\n/**\n *\n */\nlet show = function () {\n  if (!document.getElementById('dirtyWayToInjectLoginComponent')) {\n    document.body.style.overflow = 'hidden';\n    let el = document.createElement('div');\n    el.setAttribute('id', 'dirtyWayToInjectLoginComponent');\n    ReactDOM.render(\n      <LoginComponent/>,\n      document.body.appendChild(el)\n    );\n  }\n};\n\n/**\n *\n * @param {Function|Boolean} callback - Option.\n */\nlet hide = function (callback = false) {\n  let el = document.getElementById('dirtyWayToInjectLoginComponent');\n  if (el) {\n    document.body.style.overflow = null;\n    ReactDOM.unmountComponentAtNode(el);\n    document.body.removeChild(el);\n    if (typeof callback === 'function') {\n      callback();\n    }\n  }\n};\n\nexport const LoginComponentEvolution = {show, hide};\n\n","import css from 'styled-jsx/css';\n\nexport default css`#wrapped-login {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: rgba(0, 0, 0, 0.9);\n  position: fixed;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  z-index: 99999;\n}\n\n#login {\n  width: 350px;\n}\n\nh2 {\n  color: #6D7781;\n  font-family: 'Sofia', cursive;\n  font-size: 3.5em;\n  font-weight: bold;\n  text-align: center;\n  margin-bottom: 20px;\n}\n\na {\n  color: #435160;\n  text-decoration: none;\n}\n\ninput[type=\"text\"], input[type=\"password\"], input[type=\"email\"] {\n  width: 350px;\n  padding: 20px 0;\n  background: transparent !important;\n  border: 0;\n  border-bottom: 1px solid #435160;\n  outline: none;\n  color: #6D7781;\n  font-size: 16px;\n}\n\n.social {\n  position: relative;\n}\n\n.social:after {\n  content: 'OR';\n  font-size: 17px;\n  color: #435160;\n  position: absolute;\n  top: 20px;\n  font-family: 'Sofia', cursive;\n}\n\n.social span {\n  font-size: 24px;\n  padding: 9px;\n  margin: 0 5px;\n}\n\n.social .facebook {\n  color: #e4e2b8;\n}\n\n.social .twitter {\n  color: #e4e2b8;\n}\n\n.social .google-plus {\n  color: #e4e2b8;\n}\n\n.social .youtube {\n  color: #e4e2b8;\n}\n\n.forgot {\n  margin-top: 30px;\n  display: block;\n  font-size: 11px;\n  text-align: center;\n  font-weight: bold;\n}\n\n.forgot:hover {\n  margin-top: 30px;\n  display: block;\n  font-size: 11px;\n  text-align: center;\n  font-weight: bold;\n  color: #6D7781;\n}\n\n::-webkit-input-placeholder {\n  color: #435160;\n  font-size: 12px;\n}\n\ninput[type=\"submit\"] {\n  background: #3A5059;\n  border: 0;\n  width: 350px;\n  height: 40px;\n  border-radius: 3px;\n  color: #fff;\n  font-size: 12px;\n  cursor: pointer;\n  transition: background .3s ease-in-out;\n  animation-fill-mode: both;\n  animation-duration: 1s;\n}\n\ninput[type=\"submit\"]:hover {\n  background: #35566b;\n  animation-name: shake;\n}\n\n@keyframes shake {\n  0%, 100% {\n    transform: translateX(0);\n  }\n  10%, 30%, 50%, 70%, 90% {\n    transform: translateX(-10px);\n  }\n  20%, 40%, 60%, 80% {\n    transform: translateX(10px);\n  }\n}\n`","import axios from 'axios';\nimport cookie from './cookie.service';\nimport {AlertComponentEvolution} from '../components/alert';\nimport {LoginComponentEvolution} from '../components/login';\nimport Router from 'next/router';\nimport {express_api} from './express_api.service';\n\n/**\n *\n * @param req - if request come from Nextjs server, we've merely pass this params\n * @returns {AxiosInstance}\n */\nexport const axiosInstance = function (req) {\n  let token;\n  if (req) {\n    token = cookie.serverGetCookieByName(req, 'token');\n  } else {\n    token = cookie.clientGetCookieByName('token');\n  }\n  \n  let axiosInstance = axios.create({\n    timeout: 9000\n  });\n  axiosInstance.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n  \n  /**\n   * Add a request interceptor to verify before send request\n   * Request never sent if token is invalid\n   */\n  axiosInstance.interceptors.request.use(function (config) {\n    // Hàm này được gọi trước khi request được gửi đi.\n    // Do something before request is sent, if it's ok, you must be return \"config\" otherwise request never be sent\n    \n    let userProfile = cookie.verifyJWT(token);\n    if (!userProfile && config.url !== express_api.webLoginTraditionalUrl) {\n      // Ném ra 1 lỗi và sẽ được bắt ở catch khi gửi request. Giống như việc request trả về status khác 200.\n      // Catch trong mỗi request sẽ chạy khi status response khác 200,\n      // hoặc then ném ra 1 lỗi, hoặc ở đây (trước khi request) ném ra 1 lỗi\n      // throw new Error('token error');\n      LoginComponentEvolution.show();\n      return;\n    }\n    return config;\n  }, function (error) {\n    // Không biết hàm này trigger khi nào\n    // Do something with request error\n    console.log('axios handle request error: ',error);\n    return Promise.reject(error);\n  });\n  \n  // Add a response interceptor\n  axiosInstance.interceptors.response.use(function (response) {\n    // Hàm này chạy khi có response trả về với status = 200, hàm này chạy trước rồi đến then.\n    // Do something with response data\n    return response;\n  }, function (error) {\n    // Hàm này được gọi khi request trả về status khác 200 tức là response lỗi.\n    // Sau khi hàm này chạy, catch mới chạy. Catch cũng bắt lỗi với các response có status khác 200.\n    // Do something with response error\n    return Promise.reject(error);\n  });\n  \n  return axiosInstance;\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AAiDA;AACA;AACA;AAGA;AACA;AAvDA;AAyDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvFA;AACA;AACA;AAFA;AAFA;AAMA;AACA;;;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA3BA;AAAA;AAAA;AAiCA;AAEA;;;;;;;;AA9CA;AA4FA;;;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAEA;;;;;;AAIA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;ACtIA;;;;;;;;;;;;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AAEA;;;;;;AAKA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AAEA;;;;;AAIA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;;;A","sourceRoot":""}